Exploit
-------
The impact depends on what happens to be stored on the heap immediately
following the buffer. Since a web-page can influence the activities of the main
process (e.g. it can ask it to make other HTTP requests), a certain amount of
control over the heap layout is possible. An attacker could attempt to create a
"heap feng shui"-like attack where careful manipulation of the main process'
activities allow reading of various types of information from the main process'
heap. The most obvious targets that come to mind are http request/response data
for different domains, such as log-in cookies, or session keys and function
pointers that can be used to bypass ASLR/DEP. There are undoubtedly many other
forms of interesting information that can be revealed in this way.

There are little limits to the number of times an attacker can exploit this
vulnerability, assuming the attacker can avoid triggering an access violation:
if the buffer happens to be stored at the end of the heap, attempts to exploit
this vulnerability could trigger an access violation/segmentation fault when
the code attempts to read beyond the buffer from unallocated memory addresses.

Fix
---
I identified and tested two approaches to fixing this bug:
+ Fix the code where it relies on the response being stored at the start of the
  buffer.

  This addresses the incorrect addressing of memory that causes this
  vulnerability in various parts of the code. The design to keep HTTP 1xx
  responses in the buffer remains unchanged.

+ Remove HTTP 1xx responses from the buffer.
  
  There was inline documentation in the source that explained why HTTP 1xx
  responses were handled in a special way, but it didn't make much sense to me.
  This fix changes the design to no longer keep the HTTP 1xx response in the
  buffer. There is an added benefit to this fix in that it removes a potential
  DoS attack, where a server responds with many large HTTP 1xx replies, all of
  which are kept in memory and eventually cause an OOM crash in the main
  process.

The later fix was eventually implemented.

Time-line
---------
* *27 September 2013*: This vulnerability and two patches were submitted to
  [the Chromium bugtracker][].
* *2 October 2013*: [A patch][] for this vulnerability was submitted by Google.
* *12 November 2013*: This vulnerability was address in [version
  31.0.1650.48][].
* *19 December 2016*: Details of this vulnerability are released.

[the Chromium bugtracker]: https://bugs.chromium.org/p/chromium/issues/detail?id=299892
[A patch]: https://codereview.chromium.org/25312002
[version 31.0.1650.48]: https://chromereleases.googleblog.com/2013/11/stable-channel-update.html
