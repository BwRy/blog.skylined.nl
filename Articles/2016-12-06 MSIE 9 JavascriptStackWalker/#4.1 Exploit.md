Exploit
-------
As mentioned above, the vulnerable pointer points to valid stack memory during
the first exception, but it is "popped" from the stack before the second. In
order to exploit this vulnerability, the code executed during the first
exception is going to point this pointer to a specific area of the stack, while
the code executed during the second is going to allocate certain values in that
same area before the pointer is re-used.

Control over the stack contents during a stack exhaustion can be achieved by
making the recursive calls with many arguments, all of which are stored on the
stack. This is similar to a heap-spray storing values on large sections of the
heap in that it is not entirely deterministic, but the odds are very highly in
favor of you setting a certain value at a certain address.

The exploit triggers the first exception by making recursive calls using a lot
of arguments. In each loop, a lot of stack space is needed to make the next
call. At some point there will not be enough stack space left to make another
call and an exception is thrown. If `N` arguments are passed during each call,
`N*4` bytes of stack are needed to store them. The number of bytes left on the
stack at the time of the exception varies from `0` to about `4*N` and thus
averages to about `4*N/2`. The vulnerable pointer gets initialized to point to
an address near the stack pointer at the time of the exception, at
approximately `(bottom of stack) + 4*N/2`.

The exploit then triggers another stack exhaustion by making recursive calls
using many arguments, but significantly less than before. If `M` arguments are
passed during each call this time, the number of bytes left on the stack
at the time of the exception averages to about `4*M/2`.

When the second exception happens, the vulnerable pointer points inside the
stack that was "sprayed" with function arguments. This means we can control
where it points to. The pointer is used as an object pointer to get a function
address from a vftable, so by using the right value to spray the stack, we can
gain full control over execution flow.

The below schematic shows the layout of the stack during the various stages of
this exploit: